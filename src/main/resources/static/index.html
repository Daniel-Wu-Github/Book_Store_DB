<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Bookstore — Quick View</title>
    <style>
      body { font-family: Arial, Helvetica, sans-serif; margin: 24px; }
      li { margin: 8px 0; padding: 8px; border: 1px solid #eee; border-radius: 6px; }
    </style>
  </head>
  <body>
    <h1>Bookstore — Quick View</h1>
    <div id="status">Loading…</div>
    <ul id="books"></ul>

    <script>
      async function fetchBooks() {
        const status = document.getElementById('status');
        const booksEl = document.getElementById('books');
        try {
          // If your backend requires Basic auth (dev), uncomment the line below and set credentials
          const headers = new Headers();
          // headers.set('Authorization', 'Basic ' + btoa('admin:admin'));

          const res = await fetch('/api/books', { headers });
          if (!res.ok) throw new Error('HTTP ' + res.status);
          const books = await res.json();
          status.textContent = `Loaded ${books.length} books.`;
          booksEl.innerHTML = books.map(b => `\n            <li>\n              <strong>${escapeHtml(b.title)}</strong> — <em>${escapeHtml(b.author)}</em><br/>\n              ISBN: ${escapeHtml(b.isbn||'')} — $${b.price}<br/>\n              ${escapeHtml(b.description||'')}\n            </li>\n          `).join('');
        } catch (err) {
          status.textContent = 'Error: ' + err.message;
        }
      }
      function escapeHtml(s){ return String(s||'').replace(/[&<>\"]/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[c])); }
      fetchBooks();
    </script>
  </body>
</html>
